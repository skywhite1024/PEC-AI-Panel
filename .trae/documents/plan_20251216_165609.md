# 圆形饼图修复计划

## 问题分析
饼图当前显示为三角形而不是圆形，这是因为使用 `stroke-dasharray` 和 `stroke-dashoffset` 结合宽描边的方式存在局限性。当描边宽度接近圆的直径时，会导致边缘变形，特别是在扇形交界处。

## 解决方案
使用 SVG 的 `path` 元素绘制扇形，这是绘制饼图的更可靠方法。通过计算每个扇形的起始和结束角度，使用 `arc` 命令绘制曲线。

## 实现步骤

### 1. 修改 CustomPieChart 组件
在 `PanelComponents.tsx` 中重写 `CustomPieChart` 组件的 SVG 部分：

- 移除所有 `circle` 元素
- 使用 `path` 元素绘制三个扇形
- 计算每个扇形的起始和结束角度
- 使用 `M`（移动）、`L`（直线）和 `A`（圆弧）命令绘制扇形路径
- 保持原有颜色方案和标签位置

### 2. 实现角度计算逻辑
- 根据权重值计算每个扇形的角度（0-360度）
- 转换角度为弧度（用于 SVG 路径计算）
- 计算圆弧的起点和终点坐标
- 使用 `A` 命令绘制圆弧（半径、x/y 半径、旋转、大弧标志、 sweep 标志、终点坐标）

### 3. 保持动态效果
- 保留原有权重值计算逻辑
- 确保扇形大小随输入值动态变化
- 保持标签位置不变

### 4. 测试效果
- 确保饼图显示为圆形
- 验证三种颜色正确显示
- 检查扇形大小随输入值变化
- 确保标签位置正确

## 文件修改
- `components/PanelComponents.tsx` - 重写 `CustomPieChart` 组件的 SVG 部分

## 技术细节
- 使用 SVG `path` 元素的 `d` 属性绘制扇形
- 角度计算：360度 × 权重比例
- 弧度转换：角度 × π / 180
- 坐标计算：x = cx + r × cos(弧度), y = cy + r × sin(弧度)
- 使用 `fill` 属性显示颜色，而不是 `stroke`
- 保持容器尺寸和 viewBox 不变